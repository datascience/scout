{{#partial "title"}}Scout - Browse - Category{{/partial}} {{#partial
"NavBrowseClass"}}active{{/partial}} {{#partial "content"}}
<div class="container">
	{{#entityType}}
	<h1>Category {{name}}</h1>
	<p>{{description}}</p>

	<div id="entityList" class="content">Loading entities...</div>

	<div>
		<h2>Properties</h2>
		<table class="table table-hover table-striped">
			<thead>
				<tr>
					<th>Name</th>
					<th>Description</th>
					<th>Data type</th>
				</tr>
			</thead>
			<tbody>
				{{#properties}}
				<tr>
					<td>{{name}}</td>
					<td>{{description}}</td>
					<td>{{datatype}}</td>
				</tr>
				{{/properties}}
			</tbody>
		</table>
		{{^properties}}
		<div class="alert alert-warning">
			<b>Empty!</b> There are no defined properties.
		</div>
		{{/properties}}
	</div>
	{{/entityType}} {{^entityType}}
	<div class="alert alert-error">
		<b>Not found!</b> Could not find a category with name '{{typeName}}'.
	</div>
	{{/entityType}}
</div>
{{/partial}} {{#partial "scripts"}}
<script>
	function updateEntityList(start) {
		var entityType = "{{#with entityType}}{{name}}{{/with}}";
		var max = 30;
		var count = {{entityCount}};
		var end = start+max<count?start+max:count;
		var next = end<count?end:start;
		var previous = start-max<0?0:start-max;
		$.getJSON('{{contextPath}}/api/entity.json/list?type=' + entityType
				+ '&start=' + start + '&max=' + max, function(data) {
			var template = Handlebars.templates['entities_list.hbs'];
			var context = {
					entities: data, 
					entities_index_start: start+1,
					entities_index_end: end,
					entities_count: count,
					entities_index_previous: previous,
					entities_index_next: next,
					entities_index_previous_disabled: start==0,
					entities_index_next_disabled: end==count,
					contextPath: "{{contextPath}}",
					mustacheletPath: "{{mustacheletPath}}",
					};
			console.log(context);
			var html = template(context);
			$('#entityList').html(html);
		});
	}

	$(document).ready(function() {
		// TODO update on pagination
		updateEntityList(0);
	});
</script>
{{/partial}} {{> base}}
